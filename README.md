# Exploring Gene Causality Using Phenotype-Gene Embeddings

## Project Overview

This project explores potential causality between phenotypes (observable traits) and their causal genes using embeddings generated by OpenAI's GPT-3.5 model. Through exploratory data analysis (EDA) of phenotype-gene embeddings, this project investigates whether these embeddings can indicate causal relationships. By using clustering, dimensionality reduction, and similarity metrics, we aim to identify patterns that might indicate causality, supporting research in genetics and personalized medicine.

## Dataset

The dataset can be accessed here: [Zenodo - Gene Causality Dataset](https://zenodo.org/records/11391053).

The dataset includes:
- **Phenotype-Gene Associations**: A list of phenotypes with associated genes, one of which is causal.
- **Ground Truth Labels**: Causal genes identified for each phenotype.
- **Embeddings**: 3072-dimensional embeddings for phenotypes and genes, generated using GPT-3.5.

### Files
1. **Phenotype-Gene Data**: `opentargets_step2.for_llm.tsv`
2. **Ground Truth Labels**: `opentargets_step2.labels`
3. **Gene Embeddings**: `gene_embeddings.csv`
4. **Phenotype Embeddings**: `phenotype_embeddings.csv`

## Project Objectives

1. **Data Preparation**
   - Hash a given name to create a seed for consistent sampling.
   - Sample 500 phenotypes to create a unique subset for analysis.

2. **Exploratory Analysis**
   - Analyze relationships within phenotype-gene embeddings to find patterns related to causality.
   - Apply dimensionality reduction techniques (PCA, t-SNE, UMAP) for visualization.
   - Perform clustering (KMeans, Agglomerative) and evaluate clusters using silhouette scores.

3. **Causality Detection**
   - Use cosine similarity and Euclidean distance to assess relationships between phenotype-gene pairs.
   - Test if embeddings can indicate causal vs. non-causal relationships.

## Methods

1. **Dimensionality Reduction**
   - **PCA**: Capture main variance in linear embedding relationships.
   - **t-SNE and UMAP**: Reveal non-linear structures, preserving both global and local structure.

2. **Clustering Analysis**
   - **KMeans and Agglomerative Clustering**: Group embeddings to identify potential causal clusters.
   - **Silhouette Scores**: Measure cluster quality.

3. **Vector and Similarity Analysis**
   - Calculate cosine similarity and Euclidean distance to quantify relationships.
   - Use derived vectors to analyze possible causal signals.

## Results and Insights

1. **Visualization**: PCA, t-SNE, and UMAP plots visualize relationships within phenotype and gene embeddings.
2. **Clustering**: KMeans and Agglomerative clustering reveal possible causality-related clusters.
3. **Causality Signals**: High cosine similarity and low Euclidean distances in certain phenotype-gene pairs suggest potential causality.

## Future Directions

- **Dataset Expansion**: Use larger datasets for enhanced insights.
- **Advanced Clustering**: Explore clustering techniques like DBSCAN for complex patterns.
- **Causality Inference**: Integrate methods like Bayesian networks for robust causality detection.
- **Biological Validation**: Validate findings through biological databases and experimental studies.

## Resources
- [OpenAI Embeddings Documentation](https://platform.openai.com/docs/guides/embeddings)
- [Phenotypes and Genotypes](https://www.genome.gov/genetics-glossary)
